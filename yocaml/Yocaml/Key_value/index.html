<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Key_value (yocaml.Yocaml.Key_value)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.3.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">yocaml</a> &#x00BB; <a href="../index.html">Yocaml</a> &#x00BB; Key_value</nav><header class="odoc-preamble"><h1>Module <code><span>Yocaml.Key_value</span></code></h1><p>To attach additional content to documents, <code>YOCaml</code> uses a Metadata mechanism. Generally, the formats used for this kind of metadata (<code>Yaml</code>, <code>JSON</code> or even <code>TOML</code>) can be abstractly represented as abstract objects, like a key-value table.</p><p>This module abstracts the validation logic and the representation for key-value structured data.</p></header><nav class="odoc-toc"><ul><li><a href="#validation">Validation</a><ul><li><a href="#the-set-of-visitors-for-a-key-value-structurable-object">The set of visitors for a key-value structurable object</a></li><li><a href="#description-of-a-set-of-validation-rules">Description of a set of validation rules</a></li><li><a href="#producing-a-concrete-module-of-validation-rules">Producing a concrete module of validation rules</a></li></ul></li><li><a href="#representation">Representation</a></li><li><a href="#jsonm">Jsonm</a><ul><li><a href="#structure-description">Structure description</a></li><li><a href="#validators">Validators</a></li><li><a href="#descriptor">Descriptor</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="validation"><a href="#validation" class="anchor"></a>Validation</h2><p>To be able to validate structured data, one must first provide visitors for each data type supported by the metadata description logic.</p><div class="odoc-spec"><div class="spec type anchored" id="type-visitor"><a href="#type-visitor" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, 'b, 'c) visitor</span></span><span> = <span><span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span></span></code></div><div class="spec-doc"><p>A visitor takes a structured data structure and if it respects the expected schema, applies a function with the extracted data, otherwise it applies another function. In a slightly less generic way, the function that acts on the extracted data can act as a validation and the one that is applied in case of non respect of the structure is the failure function.</p></div></div><h3 id="the-set-of-visitors-for-a-key-value-structurable-object"><a href="#the-set-of-visitors-for-a-key-value-structurable-object" class="anchor"></a>The set of visitors for a key-value structurable object</h3><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-VALIDABLE"><a href="#module-type-VALIDABLE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-VALIDABLE/index.html">VALIDABLE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Creating a set of validators for a key-value structure only involves implementing the <a href="module-type-VALIDABLE/index.html"><code>VALIDABLE</code></a> module.</p></div></div><h3 id="description-of-a-set-of-validation-rules"><a href="#description-of-a-set-of-validation-rules" class="anchor"></a>Description of a set of validation rules</h3><p>If we have a representation of a key-value object (<a href="module-type-VALIDABLE/index.html"><code>VALIDABLE</code></a>) we can derive the API of its validator.</p><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-VALIDATOR"><a href="#module-type-VALIDATOR" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-VALIDATOR/index.html">VALIDATOR</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The full API derived by operating a representation.</p></div></div><h3 id="producing-a-concrete-module-of-validation-rules"><a href="#producing-a-concrete-module-of-validation-rules" class="anchor"></a>Producing a concrete module of validation rules</h3><p>Produces a module from a module with type <a href="module-type-VALIDABLE/index.html"><code>VALIDABLE</code></a> to a module with type <a href="module-type-VALIDATOR/index.html"><code>VALIDATOR</code></a>.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Make_validator"><a href="#module-Make_validator" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make_validator/index.html">Make_validator</a></span><span> (<a href="Make_validator/argument-1-KV/index.html">KV</a> : <a href="module-type-VALIDABLE/index.html">VALIDABLE</a>) : <a href="module-type-VALIDATOR/index.html">VALIDATOR</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-VALIDATOR/index.html#type-t">t</a> = <a href="Make_validator/argument-1-KV/index.html#type-t">KV.t</a></span></span></code></div></div><h2 id="representation"><a href="#representation" class="anchor"></a>Representation</h2><p>Provides the minimal combinators to describe a key-value object.</p><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-DESCRIBABLE"><a href="#module-type-DESCRIBABLE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-DESCRIBABLE/index.html">DESCRIBABLE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="jsonm"><a href="#jsonm" class="anchor"></a>Jsonm</h2><p>The representation proposed by the <a href="https://erratique.ch/software/jsonm/doc/index.html">Jsonm</a> library has become so popular that it is the representation used for <a href="https://github.com/rgrinberg/ocaml-mustache">ocaml-mustache</a> and <a href="https://github.com/avsm/ocaml-yaml">ocaml-yaml</a>. As the AST is described by means of polymorphic variants, it is possible to provide validators without the need to depend on the library.</p><h3 id="structure-description"><a href="#structure-description" class="anchor"></a>Structure description</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Jsonm_object"><a href="#module-Jsonm_object" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Jsonm_object/index.html">Jsonm_object</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h3 id="validators"><a href="#validators" class="anchor"></a>Validators</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Jsonm_validator"><a href="#module-Jsonm_validator" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Jsonm_validator/index.html">Jsonm_validator</a></span><span> : <a href="module-type-VALIDATOR/index.html">VALIDATOR</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-VALIDATOR/index.html#type-t">t</a> = <a href="Jsonm_object/index.html#type-t">Jsonm_object.t</a></span></span></code></div></div><h3 id="descriptor"><a href="#descriptor" class="anchor"></a>Descriptor</h3><div class="odoc-spec"><div class="spec module anchored" id="module-Jsonm_descriptor"><a href="#module-Jsonm_descriptor" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Jsonm_descriptor/index.html">Jsonm_descriptor</a></span><span> : <a href="module-type-DESCRIBABLE/index.html">DESCRIBABLE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-DESCRIBABLE/index.html#type-t">t</a> = <a href="Jsonm_object/index.html#type-t">Jsonm_object.t</a></span></span></code></div></div></div></body></html>
