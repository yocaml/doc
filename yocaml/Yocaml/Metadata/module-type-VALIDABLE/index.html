<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>VALIDABLE (yocaml.Yocaml.Metadata.VALIDABLE)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">yocaml</a> &#x00BB; <a href="../../index.html">Yocaml</a> &#x00BB; <a href="../index.html">Metadata</a> &#x00BB; VALIDABLE</nav><header class="odoc-preamble"><h1>Module type <code><span>Metadata.VALIDABLE</span></code></h1><p>Describes how to transform and validate strings into structured objects. An example of a Validable is the <code>Yocaml_yaml</code> module.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-from_string" class="anchored"><a href="#val-from_string" class="anchor"></a><code><span><span class="keyword">val</span> from_string : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../Key_value/module-type-VALIDATOR/index.html">Key_value.VALIDATOR</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../Key_value/module-type-VALIDATOR/index.html#type-t">t</a> := <a href="#type-t">t</a></span></span></code></summary><h3 id="simple-validator"><a href="#simple-validator" class="anchor"></a>Simple validator</h3><p>Each simple validator checks that the element of type <code>t</code> given as an argument respects the expected form.</p><div class="odoc-spec"><div class="spec value" id="val-object_" class="anchored"><a href="#val-object_" class="anchor"></a><code><span><span class="keyword">val</span> object_ : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(string * <a href="#type-t">t</a>)</span> list</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>object_ term</code> checks that <code>term</code> is an <code>object</code> and extract the object as a list of <code>string * t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-list" class="anchored"><a href="#val-list" class="anchor"></a><code><span><span class="keyword">val</span> list : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-t">t</a> list</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>list term</code> checks that <code>term</code> is a <code>list</code> (and extract it).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-atom" class="anchored"><a href="#val-atom" class="anchor"></a><code><span><span class="keyword">val</span> atom : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>atom term</code> checks that <code>term</code> is an <code>atom</code>, like atoms in <code>SEXP</code> (and extract it as <code>string</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string" class="anchored"><a href="#val-string" class="anchor"></a><code><span><span class="keyword">val</span> string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>string term</code> checks that <code>term</code> is a <code>string</code> (and extract it).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-boolean" class="anchored"><a href="#val-boolean" class="anchor"></a><code><span><span class="keyword">val</span> boolean : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>bool <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>boolean term</code> checks that <code>term</code> is a <code>boolean</code> (and extract it).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-integer" class="anchored"><a href="#val-integer" class="anchor"></a><code><span><span class="keyword">val</span> integer : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>int <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>list term</code> checks that <code>term</code> is an <code>integer</code> (and extract it).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-float" class="anchored"><a href="#val-float" class="anchor"></a><code><span><span class="keyword">val</span> float : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>float term</code> checks that <code>term</code> is a <code>float</code> (and extract it).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-text" class="anchored"><a href="#val-text" class="anchor"></a><code><span><span class="keyword">val</span> text : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>string <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>text term</code> checks that <code>term</code> is not an <code>objet</code> nor a <code>list</code> (and extract the value as a <code>string</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-null" class="anchored"><a href="#val-null" class="anchor"></a><code><span><span class="keyword">val</span> null : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p>Checks that a value is Null.</p></div></div><h3 id="composable-validator"><a href="#composable-validator" class="anchor"></a>Composable validator</h3><p>In addition to validating that an element of type <code>t</code> has the expected form, a compound validator also applies an additional validation. For example <code>string_and string_has_length 3</code> to validate that the element is a string and has a size of 3 (assuming the <code>string_has_length x</code> function exists).</p><div class="odoc-spec"><div class="spec value" id="val-object_and" class="anchored"><a href="#val-object_and" class="anchor"></a><code><span><span class="keyword">val</span> object_and : <span><span>( <span><span><span>(string * <a href="#type-t">t</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>object_and validator term</code> checks that <code>term</code> is an <code>object</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-list_and" class="anchored"><a href="#val-list_and" class="anchor"></a><code><span><span class="keyword">val</span> list_and : <span><span>( <span><span><a href="#type-t">t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>list_and validator term</code> checks that <code>term</code> is a <code>list</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-list_of" class="anchored"><a href="#val-list_of" class="anchor"></a><code><span><span class="keyword">val</span> list_of : <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>list_of validator term</code>, ie: <code>list_of int</code> checks if <code>term</code> is a list that contains only values that satisfies the given validator.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-atom_and" class="anchored"><a href="#val-atom_and" class="anchor"></a><code><span><span class="keyword">val</span> atom_and : <span><span>( <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>atom_and validator term</code> checks that <code>term</code> is an <code>atom</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string_and" class="anchored"><a href="#val-string_and" class="anchor"></a><code><span><span class="keyword">val</span> string_and : <span><span>( <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>string_and validator term</code> checks that <code>term</code> is a <code>string</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-boolean_and" class="anchored"><a href="#val-boolean_and" class="anchor"></a><code><span><span class="keyword">val</span> boolean_and : <span><span>( <span>bool <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>boolean_and validator term</code> checks that <code>term</code> is a <code>boolean</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-integer_and" class="anchored"><a href="#val-integer_and" class="anchor"></a><code><span><span class="keyword">val</span> integer_and : <span><span>( <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>interger_and validator term</code> checks that <code>term</code> is an <code>integer</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-float_and" class="anchored"><a href="#val-float_and" class="anchor"></a><code><span><span class="keyword">val</span> float_and : <span><span>( <span>float <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>float_and validator term</code> checks that <code>term</code> is a <code>float</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-text_and" class="anchored"><a href="#val-text_and" class="anchor"></a><code><span><span class="keyword">val</span> text_and : <span><span>( <span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>text_and validator term</code> checks that <code>term</code> is a <code>text</code> and valid it using <code>validator</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-null_and" class="anchored"><a href="#val-null_and" class="anchor"></a><code><span><span class="keyword">val</span> null_and : <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>null_and validator term</code> checks that <code>term</code> is a <code>Null</code> and valid it using <code>validator</code>.</p></div></div><h3 id="queries-over-objects"><a href="#queries-over-objects" class="anchor"></a>Queries over objects</h3><p>As <code>object_</code> returns an associative list, you have to manipulate associative list functions over and over again to validate an object correctly, fortunately there are combinators to help with object validation.</p><div class="odoc-spec"><div class="spec value" id="val-optional_field" class="anchored"><a href="#val-optional_field" class="anchor"></a><code><span><span class="keyword">val</span> optional_field : 
  <span>?case_sensitive:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> option</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>optional_field ?case_sensitive validator key term</code> try to reach the value at the <code>key</code> position in <code>term</code>, if the key is not associated the function will apply the validation and wrap it into an option, if the association is not present the function will returns <code>None</code>. (<code>case_sensitive</code> act on the <code>key</code> and is <code>false</code> by default)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-optional_field_or" class="anchored"><a href="#val-optional_field_or" class="anchor"></a><code><span><span class="keyword">val</span> optional_field_or : 
  <span>?case_sensitive:bool <span class="arrow">&#45;&gt;</span></span>
  <span>default:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>optional_field_or ?case_sensitive ~default validator key term</code> same of <code>optional_field</code> but instead of wrapping the result into an option, it will apply <code>default</code> if the association does not exists. (<code>case_sensitive</code> act on the <code>key</code> and is <code>false</code> by default)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-required_field" class="anchored"><a href="#val-required_field" class="anchor"></a><code><span><span class="keyword">val</span> required_field : 
  <span>?case_sensitive:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p><code>required_field</code> is like <code>optional_field</code> except that the association must exist, otherwise the check fails.</p></div></div><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><p>Let's imagine this type of data:</p><pre><code>type user =
  { firstname : string
  ; lastname : string
  ; age : int
  ; activated : bool
  ; email : string option
  }

let make_user firstname lastname age activated email =
  { firstname; lastname; age; activated; email }
;;</code></pre><p>We could validate it in this way (using the standard <a href="https://github.com/xvw/preface/blob/master/guides/error_handling.md">Applicative validation</a>:</p><pre><code>let validate obj =
  let open Validate.Applicative in
  make_user
  &lt;$&gt; required_field string &quot;firstname&quot; obj
  &lt;*&gt; required_field string &quot;lastname&quot; obj
  &lt;*&gt; required_field integer &quot;age&quot; obj
  &lt;*&gt; optional_field_or ~default:false boolean &quot;activated&quot; obj
  &lt;*&gt; optional_field string &quot;email&quot; obj
;;</code></pre><h3 id="queries-over-associatives-lists"><a href="#queries-over-associatives-lists" class="anchor"></a>Queries over associatives lists</h3><p>In our previous example, we saw how to use queries on objects. Although this approach works, each validation requires the object to be deconstructed at each stage. Fortunately, it is possible, using associative lists, to deconstruct only once.</p><p>let's take our previous type and function (<code>user</code> and <code>make_user</code>):</p><pre><code>let validate_with_assoc =
  object_and (fun assoc -&gt;
    let open Validate.Applicative in
    make_user
    &lt;$&gt; required_assoc string &quot;firstname&quot; assoc
    &lt;*&gt; required_assoc string &quot;lastname&quot; assoc
    &lt;*&gt; required_assoc integer &quot;age&quot; assoc
    &lt;*&gt; optional_assoc_or ~default:false boolean &quot;activated&quot; assoc
    &lt;*&gt; optional_assoc string &quot;email&quot; assoc)
;;</code></pre><p>The result is identical to the previous one except that this time the object is only deconstructed once.</p><div class="odoc-spec"><div class="spec value" id="val-optional_assoc" class="anchored"><a href="#val-optional_assoc" class="anchor"></a><code><span><span class="keyword">val</span> optional_assoc : 
  <span>?case_sensitive:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * <a href="#type-t">t</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> option</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p>Same of <code>optional_field</code> but acting on associatives lists.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-optional_assoc_or" class="anchored"><a href="#val-optional_assoc_or" class="anchor"></a><code><span><span class="keyword">val</span> optional_assoc_or : 
  <span>?case_sensitive:bool <span class="arrow">&#45;&gt;</span></span>
  <span>default:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * <a href="#type-t">t</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p>Same of <code>optional_field_or</code> but acting on associatives lists.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-required_assoc" class="anchored"><a href="#val-required_assoc" class="anchor"></a><code><span><span class="keyword">val</span> required_assoc : 
  <span>?case_sensitive:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(string * <a href="#type-t">t</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <a href="../../Validate/index.html#type-t">Validate.t</a></span></span></code></div><div class="spec-doc"><p>Same of <code>required_field</code> but acting on associatives lists.</p></div></div></details></div></div></body></html>